<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fitting many models with rTPC • rTPC</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fitting many models with rTPC">
<meta property="og:description" content="rTPC">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-74093873-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-74093873-3');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rTPC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rTPC.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">Fitting a single curve</li>
    <li>
      <a href="../articles/fit_many_models.html">Fitting many models with rTPC</a>
    </li>
    <li>
      <a href="../articles/model_weighting.html">Model weighting with rTPC</a>
    </li>
    <li>
      <a href="../articles/model_averaging_selection.html">Model selection and model averaging with rTPC</a>
    </li>
    <li>
      <a href="../articles/bootstrapping_models.html">Bootstrapping using rTPC</a>
    </li>
    <li>
      <a href="../articles/weighted_bootstrapping.html">Bootstrapping with weights using rTPC</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Fitting many curves</li>
    <li>
      <a href="../articles/fit_many_curves.html">Fitting many curves using rTPC</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/padpadpadpad/rTPC/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="fit_many_models_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fitting many models with rTPC</h1>
                        <h4 class="author">Daniel Padfield</h4>
            
            <h4 class="date">2020-09-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/padpadpadpad/rTPC/blob/master/vignettes/fit_many_models.Rmd"><code>vignettes/fit_many_models.Rmd</code></a></small>
      <div class="hidden name"><code>fit_many_models.Rmd</code></div>

    </div>

    
    
<div id="a-brief-example-of-how-multiple-models-can-be-fitted-to-a-single-tpc-using-rtpc-nls-multstart-and-the-tidyverse-" class="section level4">
<h4 class="hasAnchor">
<a href="#a-brief-example-of-how-multiple-models-can-be-fitted-to-a-single-tpc-using-rtpc-nls-multstart-and-the-tidyverse-" class="anchor"></a>A brief example of how multiple models can be fitted to a single TPC using rTPC, nls.multstart, and the tidyverse.</h4>
<hr>
</div>
<div id="things-to-consider" class="section level2">
<h2 class="hasAnchor">
<a href="#things-to-consider" class="anchor"></a>Things to consider</h2>
<ul>
<li>How many data points do you have for each curve? To fit all of the 23 models in <strong>rTPC</strong>, there needs to be a minimum of 7 points per curve.</li>
<li>If you have multiple curves, it makes sense to have your data in long format, where grouping variables, temperature and rate have their own columns.</li>
<li>Are there negative rate values? If a curve that crosses the x axis, it might be beneficial to only consider models that are capable of modelling negative values.</li>
<li>Are there specific parameters you are interested in? If so, it may be beneficial to only consider models that explicitly include that parameter in their formulation.</li>
</ul>
<hr>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="co"># load packages</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/padpadpadpad/rTPC">rTPC</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw">nls.multstart</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://broom.tidymodels.org">broom</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span>)

<span class="co"># write function to label ggplot2 panels</span>
<span class="kw">label_facets_num</span> <span class="op">&lt;-</span> <span class="fu">function</span>(<span class="kw">string</span>){
  <span class="kw">len</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">string</span>)
  <span class="kw">string</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">'('</span>, <span class="fl">1</span><span class="op">:</span><span class="kw">len</span>, <span class="st">') '</span>, <span class="kw">string</span>, sep = <span class="st">''</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="kw">string</span>)
}
</pre></div>
<p>After searching the literature, <strong>rTPC</strong> contains 23 different model formulations previously used. The <a href="rTPC.html">first vignette</a>, demonstrated how to easily fit a single model to a single curve, here we will fit all 23 model formulations.</p>
<p><strong>DISCLAIMER Although we fit all 23 model formulations, this is to demonstrate how they fit and their general shape, we do not recommend ever doing model selection on 23 model formulations.</strong></p>
<p>We can demonstrate the fitting procedure of the 23 model formulations by taking a single curve from the example dataset <strong>rTPC</strong> - a dataset of 60 TPCs of respiration and photosynthesis of the aquatic algae, <em>Chlorella vulgaris</em>. We can plot the data using <strong>ggplot2</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="co"># load in data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"chlorella_tpc"</span>)

<span class="co"># keep just a single curve</span>
<span class="kw">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">chlorella_tpc</span>, <span class="kw">curve_id</span> <span class="op">==</span> <span class="fl">1</span>)

<span class="co"># show the data</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">d</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">temp</span>, <span class="kw">rate</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>(base_size = <span class="fl">12</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(x = <span class="st">'Temperature (ºC)'</span>,
       y = <span class="st">'Metabolic rate'</span>,
       title = <span class="st">'Respiration across temperatures'</span>)
</pre></div>
<p><img src="fit_many_models_files/figure-html/first_plot-1.png" width="576" style="display: block; margin: auto;"></p>
<p>When fitting multiple models, we take advantage of list columns and functionality provided by <strong>purrr</strong>. A great introduction to this is the “<a href="https://r4ds.had.co.nz/many-models.html">Many Models</a>” Chapter of R for Data Science.</p>
<p>For a single curve, we nest the dataframe, creating a list column which contains the temperature and rate values. We then create separate columns for each model fit using <strong>purrr::map()</strong>. Here, we use a gridstart approach when fitting models with <strong>nls_multstart()</strong>. This method creates a combination of start parameters, equally spaced across each of the starting parameter bounds. This can be specified with a vector of the same length as the number of parameters, c(5, 5, 5) for 3 estimated parameters will yield 125 iterations.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="co"># fit every model formulation in rTPC</span>
<span class="kw">d_fits</span> <span class="op">&lt;-</span> <span class="fu">nest</span>(<span class="kw">d</span>, data = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">temp</span>, <span class="kw">rate</span>)) <span class="op">%&gt;%</span>
  <span class="fu">mutate</span>(beta = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/beta_2012.html">beta_2012</a></span>(temp = <span class="kw">temp</span>, <span class="kw">a</span>, <span class="kw">b</span>, <span class="kw">c</span>, <span class="kw">d</span>, <span class="kw">e</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">6</span>,<span class="fl">6</span>,<span class="fl">6</span>,<span class="fl">6</span>,<span class="fl">6</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'beta_2012'</span>) <span class="op">-</span> <span class="fl">10</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'beta_2012'</span>) <span class="op">+</span> <span class="fl">10</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'beta_2012'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'beta_2012'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         boatman = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/boatman_2017.html">boatman_2017</a></span>(temp = <span class="kw">temp</span>, <span class="kw">rmax</span>, <span class="kw">tmin</span>, <span class="kw">tmax</span>, <span class="kw">a</span>,<span class="kw">b</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'boatman_2017'</span>) <span class="op">-</span> <span class="fl">10</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'boatman_2017'</span>) <span class="op">+</span> <span class="fl">10</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'boatman_2017'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'boatman_2017'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         briere2 = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/briere2_1999.html">briere2_1999</a></span>(temp = <span class="kw">temp</span>, <span class="kw">tmin</span>, <span class="kw">tmax</span>, <span class="kw">a</span>,<span class="kw">b</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'briere2_1999'</span>) <span class="op">-</span> <span class="fl">10</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'briere2_1999'</span>) <span class="op">+</span> <span class="fl">10</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'briere2_1999'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'briere2_1999'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         delong = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/delong_2017.html">delong_2017</a></span>(temp = <span class="kw">temp</span>, <span class="kw">c</span>, <span class="kw">eb</span>, <span class="kw">ef</span>, <span class="kw">tm</span>, <span class="kw">ehc</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'delong_2017'</span>) <span class="op">-</span> <span class="fl">10</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'delong_2017'</span>) <span class="op">+</span> <span class="fl">10</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'delong_2017'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'delong_2017'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         flinn = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/flinn_1991.html">flinn_1991</a></span>(temp = <span class="kw">temp</span>, <span class="kw">a</span>, <span class="kw">b</span>, <span class="kw">c</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'flinn_1991'</span>) <span class="op">-</span> <span class="fl">10</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'flinn_1991'</span>) <span class="op">+</span> <span class="fl">10</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'flinn_1991'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'flinn_1991'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         gaussian = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/gaussian_1987.html">gaussian_1987</a></span>(temp = <span class="kw">temp</span>, <span class="kw">rmax</span>, <span class="kw">topt</span>, <span class="kw">a</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'gaussian_1987'</span>) <span class="op">-</span> <span class="fl">10</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'gaussian_1987'</span>) <span class="op">+</span> <span class="fl">10</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'gaussian_1987'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'gaussian_1987'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         hinshelwood = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/hinshelwood_1947.html">hinshelwood_1947</a></span>(temp = <span class="kw">temp</span>, <span class="kw">a</span>, <span class="kw">e</span>, <span class="kw">b</span>, <span class="kw">eh</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'hinshelwood_1947'</span>) <span class="op">-</span> <span class="fl">1</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'hinshelwood_1947'</span>) <span class="op">+</span> <span class="fl">1</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'hinshelwood_1947'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'hinshelwood_1947'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         joehnk = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/joehnk_2008.html">joehnk_2008</a></span>(temp = <span class="kw">temp</span>, <span class="kw">rmax</span>, <span class="kw">topt</span>, <span class="kw">a</span>, <span class="kw">b</span>, <span class="kw">c</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>, <span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'joehnk_2008'</span>) <span class="op">-</span> <span class="fl">10</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'joehnk_2008'</span>) <span class="op">+</span> <span class="fl">10</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'joehnk_2008'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'joehnk_2008'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         johnson_lewin = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span> <span class="fu"><a href="../reference/johnsonlewin_1946.html">johnsonlewin_1946</a></span>(temp = <span class="kw">temp</span>, <span class="kw">r0</span>, <span class="kw">e</span>, <span class="kw">eh</span>, <span class="kw">topt</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'johnsonlewin_1946'</span>) <span class="op">-</span> <span class="fl">1</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'johnsonlewin_1946'</span>) <span class="op">+</span> <span class="fl">1</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'johnsonlewin_1946'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'johnsonlewin_1946'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>))),
         kamykowski = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/kamykowski_1985.html">kamykowski_1985</a></span>(temp = <span class="kw">temp</span>, <span class="kw">tmin</span>, <span class="kw">tmax</span>, <span class="kw">a</span>, <span class="kw">b</span>, <span class="kw">c</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'kamykowski_1985'</span>) <span class="op">-</span> <span class="fl">10</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'kamykowski_1985'</span>) <span class="op">+</span> <span class="fl">10</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'kamykowski_1985'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'kamykowski_1985'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         lactin2 = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/lactin2_1995.html">lactin2_1995</a></span>(temp = <span class="kw">temp</span>, <span class="kw">a</span>, <span class="kw">b</span>, <span class="kw">tmax</span>, <span class="kw">delta_t</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'lactin2_1995'</span>) <span class="op">-</span> <span class="fl">10</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'lactin2_1995'</span>) <span class="op">+</span> <span class="fl">10</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'lactin2_1995'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'lactin2_1995'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         modifiedgaussian = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/modifiedgaussian_2006.html">modifiedgaussian_2006</a></span>(temp = <span class="kw">temp</span>, <span class="kw">rmax</span>, <span class="kw">topt</span>, <span class="kw">a</span>, <span class="kw">b</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'modifiedgaussian_2006'</span>) <span class="op">-</span> <span class="fl">10</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'modifiedgaussian_2006'</span>) <span class="op">+</span> <span class="fl">10</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'modifiedgaussian_2006'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'modifiedgaussian_2006'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         oneill = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/oneill_1972.html">oneill_1972</a></span>(temp = <span class="kw">temp</span>, <span class="kw">rmax</span>, <span class="kw">ctmax</span>, <span class="kw">topt</span>, <span class="kw">q10</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'oneill_1972'</span>) <span class="op">-</span> <span class="fl">10</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'oneill_1972'</span>) <span class="op">+</span> <span class="fl">10</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'oneill_1972'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'oneill_1972'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         pawar = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/pawar_2018.html">pawar_2018</a></span>(temp = <span class="kw">temp</span>, <span class="kw">r_tref</span>, <span class="kw">e</span>, <span class="kw">eh</span>, <span class="kw">topt</span>, tref = <span class="fl">15</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'pawar_2018'</span>) <span class="op">-</span> <span class="fl">10</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'pawar_2018'</span>) <span class="op">+</span> <span class="fl">10</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'pawar_2018'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'pawar_2018'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         quadratic = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/quadratic_2008.html">quadratic_2008</a></span>(temp = <span class="kw">temp</span>, <span class="kw">a</span>, <span class="kw">b</span>, <span class="kw">c</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'quadratic_2008'</span>) <span class="op">-</span> <span class="fl">0.5</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'quadratic_2008'</span>) <span class="op">+</span> <span class="fl">0.5</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'quadratic_2008'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'quadratic_2008'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         ratkowsky = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/ratkowsky_1983.html">ratkowsky_1983</a></span>(temp = <span class="kw">temp</span>, <span class="kw">tmin</span>, <span class="kw">tmax</span>, <span class="kw">a</span>, <span class="kw">b</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'ratkowsky_1983'</span>) <span class="op">-</span> <span class="fl">10</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'ratkowsky_1983'</span>) <span class="op">+</span> <span class="fl">10</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'ratkowsky_1983'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'ratkowsky_1983'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         rezende = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/rezende_2019.html">rezende_2019</a></span>(temp = <span class="kw">temp</span>, <span class="kw">q10</span>, <span class="kw">a</span>,<span class="kw">b</span>,<span class="kw">c</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'rezende_2019'</span>) <span class="op">-</span> <span class="fl">10</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'rezende_2019'</span>) <span class="op">+</span> <span class="fl">10</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'rezende_2019'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'rezende_2019'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         sharpeschoolfull = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/sharpeschoolfull_1981.html">sharpeschoolfull_1981</a></span>(temp = <span class="kw">temp</span>, <span class="kw">r_tref</span>,<span class="kw">e</span>,<span class="kw">el</span>,<span class="kw">tl</span>,<span class="kw">eh</span>,<span class="kw">th</span>, tref = <span class="fl">15</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'sharpeschoolfull_1981'</span>) <span class="op">-</span> <span class="fl">10</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'sharpeschoolfull_1981'</span>) <span class="op">+</span> <span class="fl">10</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'sharpeschoolfull_1981'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'sharpeschoolfull_1981'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         sharpeschoolhigh = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/sharpeschoolhigh_1981.html">sharpeschoolhigh_1981</a></span>(temp = <span class="kw">temp</span>, <span class="kw">r_tref</span>,<span class="kw">e</span>,<span class="kw">eh</span>,<span class="kw">th</span>, tref = <span class="fl">15</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'sharpeschoolhigh_1981'</span>) <span class="op">-</span> <span class="fl">10</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'sharpeschoolhigh_1981'</span>) <span class="op">+</span> <span class="fl">10</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'sharpeschoolhigh_1981'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'sharpeschoolhigh_1981'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         sharpeschoollow = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/sharpeschoollow_1981.html">sharpeschoollow_1981</a></span>(temp = <span class="kw">temp</span>, <span class="kw">r_tref</span>,<span class="kw">e</span>,<span class="kw">el</span>,<span class="kw">tl</span>, tref = <span class="fl">15</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'sharpeschoollow_1981'</span>) <span class="op">-</span> <span class="fl">10</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'sharpeschoollow_1981'</span>) <span class="op">+</span> <span class="fl">10</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'sharpeschoollow_1981'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'sharpeschoollow_1981'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         spain = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/spain_1982.html">spain_1982</a></span>(temp = <span class="kw">temp</span>, <span class="kw">a</span>,<span class="kw">b</span>,<span class="kw">c</span>,<span class="kw">r0</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'spain_1982'</span>) <span class="op">-</span> <span class="fl">1</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'spain_1982'</span>) <span class="op">+</span> <span class="fl">1</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'spain_1982'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'spain_1982'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         thomas1 = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/thomas_2012.html">thomas_2012</a></span>(temp = <span class="kw">temp</span>, <span class="kw">a</span>,<span class="kw">b</span>,<span class="kw">c</span>,<span class="kw">topt</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'thomas_2012'</span>) <span class="op">-</span> <span class="fl">1</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'thomas_2012'</span>) <span class="op">+</span> <span class="fl">2</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'thomas_2012'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'thomas_2012'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         thomas2 = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/thomas_2017.html">thomas_2017</a></span>(temp = <span class="kw">temp</span>, <span class="kw">a</span>,<span class="kw">b</span>,<span class="kw">c</span>,<span class="kw">d</span>,<span class="kw">e</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'thomas_2017'</span>) <span class="op">-</span> <span class="fl">10</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'thomas_2017'</span>) <span class="op">+</span> <span class="fl">10</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'thomas_2017'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'thomas_2017'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)),
         weibull = <span class="fu">map</span>(<span class="kw">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="kw">rate</span><span class="op">~</span><span class="fu"><a href="../reference/weibull_1995.html">weibull_1995</a></span>(temp = <span class="kw">temp</span>, <span class="kw">a</span>,<span class="kw">topt</span>,<span class="kw">b</span>,<span class="kw">c</span>),
                        data = <span class="kw">.x</span>,
                        iter = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        start_lower = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'weibull_1995'</span>) <span class="op">-</span> <span class="fl">10</span>,
                        start_upper = <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'weibull_1995'</span>) <span class="op">+</span> <span class="fl">10</span>,
                        lower = <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'weibull_1995'</span>),
                        upper = <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="kw">.x</span><span class="op">$</span><span class="kw">temp</span>, <span class="kw">.x</span><span class="op">$</span><span class="kw">rate</span>, model_name = <span class="st">'weibull_1995'</span>),
                        supp_errors = <span class="st">'Y'</span>,
                        convergence_count = <span class="fl">FALSE</span>)))
</pre></div>
<p>This gives us a dataframe with our grouping variables <code>curve_id</code>, <code>growth_temp</code>, <code>process</code>, and <code>flux</code> first (not used here, but demonstrate how this can be scaled to multiple curves). Next is our <code>data</code> column which contains our temperature and rate data. Then is a column for each of our models.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="fu">glimpse</span>(<span class="fu">select</span>(<span class="kw">d_fits</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span>))
<span class="co">#&gt; Rows: 1</span>
<span class="co">#&gt; Columns: 7</span>
<span class="co">#&gt; $ curve_id    &lt;dbl&gt; 1</span>
<span class="co">#&gt; $ growth_temp &lt;dbl&gt; 20</span>
<span class="co">#&gt; $ process     &lt;chr&gt; "acclimation"</span>
<span class="co">#&gt; $ flux        &lt;chr&gt; "respiration"</span>
<span class="co">#&gt; $ data        &lt;list&gt; [&lt;tbl_df[12 x 2]&gt;]</span>
<span class="co">#&gt; $ beta        &lt;list&gt; [&lt;function () , resid, function () , rhs, function () , …</span>
<span class="co">#&gt; $ boatman     &lt;list&gt; [&lt;function () , resid, function () , rhs, function () , …</span>
</pre></div>
<p>Each column containing the model stores the actual model fit.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">d_fits</span><span class="op">$</span><span class="kw">beta</span>[[<span class="fl">1</span>]]
<span class="co">#&gt; Nonlinear regression model</span>
<span class="co">#&gt;   model: rate ~ beta_2012(temp = temp, a, b, c, d, e)</span>
<span class="co">#&gt;    data: data</span>
<span class="co">#&gt;       a       b       c       d       e </span>
<span class="co">#&gt;   1.496  36.329 203.403 100.000 100.000 </span>
<span class="co">#&gt;  residual sum-of-squares: 0.9615</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of iterations to convergence: 20 </span>
<span class="co">#&gt; Achieved convergence tolerance: 1.49e-08</span>
</pre></div>
<p>The parameters from each model fit can be extracted using <strong>broom::tidy()</strong>. However, as each model has parameters with different meanings, this may not be very useful in this instance.</p>
<p>The predictions of each model can be estimated using <strong>broom::augment()</strong>. This can be done on all models at once after the models are stacked into long format. To create a smooth curve fit, the predictions are done on a new temperature vector that has 100 points over the temperature range. The predictions for each model formulation are then visualised in <strong>ggplot2</strong>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="co"># stack models</span>
<span class="kw">d_stack</span> <span class="op">&lt;-</span> <span class="fu">select</span>(<span class="kw">d_fits</span>, <span class="op">-</span><span class="kw">data</span>) <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span>(<span class="kw">.</span>, names_to = <span class="st">'model_name'</span>, values_to = <span class="st">'fit'</span>, <span class="kw">beta</span><span class="op">:</span><span class="kw">weibull</span>)

<span class="co"># get parameters using tidy</span>
<span class="kw">params</span> <span class="op">&lt;-</span> <span class="kw">d_stack</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">.</span>, est = <span class="fu">map</span>(<span class="kw">fit</span>, <span class="kw">tidy</span>)) <span class="op">%&gt;%</span>
  <span class="fu">select</span>(<span class="op">-</span><span class="kw">fit</span>) <span class="op">%&gt;%</span>
  <span class="fu">unnest</span>(<span class="kw">est</span>)

<span class="co"># get predictions using augment</span>
<span class="kw">newdata</span> <span class="op">&lt;-</span> <span class="fu">tibble</span>(temp = <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="kw">d</span><span class="op">$</span><span class="kw">temp</span>), <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="kw">d</span><span class="op">$</span><span class="kw">temp</span>), length.out = <span class="fl">100</span>))
<span class="kw">d_preds</span> <span class="op">&lt;-</span> <span class="kw">d_stack</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">.</span>, preds = <span class="fu">map</span>(<span class="kw">fit</span>, <span class="kw">augment</span>, newdata = <span class="kw">newdata</span>)) <span class="op">%&gt;%</span>
  <span class="fu">select</span>(<span class="op">-</span><span class="kw">fit</span>) <span class="op">%&gt;%</span>
  <span class="fu">unnest</span>(<span class="kw">preds</span>)

<span class="co"># plot</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">d_preds</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">temp</span>, <span class="kw">rate</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">temp</span>, <span class="kw">rate</span>), <span class="kw">d</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">temp</span>, <span class="kw">.fitted</span>), col = <span class="st">'blue'</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span><span class="kw">model_name</span>, labeller = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html">labeller</a></span>(model_name = <span class="kw">label_facets_num</span>), scales = <span class="st">'free'</span>, ncol = <span class="fl">4</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>(base_size = <span class="fl">12</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(legend.position = <span class="st">'none'</span>,
        strip.text = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(hjust = <span class="fl">0</span>),
        strip.background = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>()) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(x = <span class="st">'Temperature (ºC)'</span>,
       y = <span class="st">'Metabolic rate'</span>,
       title = <span class="st">'Fits of every model available in rTPC'</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(yintercept = <span class="fl">0</span>), linetype = <span class="fl">2</span>)
</pre></div>
<p><img src="fit_many_models_files/figure-html/preds_and_plot-1.png" width="768" style="display: block; margin: auto;"></p>
<hr>
</div>
<div id="troubleshooting-curve-fits" class="section level2">
<h2 class="hasAnchor">
<a href="#troubleshooting-curve-fits" class="anchor"></a>Troubleshooting curve fits</h2>
<p>If any of the fits do not look like they have converged properly, there are things you can try:</p>
<ul>
<li>Some functions may produce warnings (for example: <code>NaNs produced</code>). This is likely due to a specific set of start parameters and does not necessarily mean <strong>nls_multstart()</strong> has failed. Wrap <strong>nls_multstart()</strong> in <strong>suppressWarnings()</strong> to turn this behaviour off.</li>
<li>Change from the gridstart approach to the shotgun approach of fitting models with <strong>nls_multstart()</strong>
</li>
<li>Change the boundaries of <code>start_lower</code> and <code>start_upper</code>. In most of these fits, we just +/- 10 from the output of <strong>get_start_vals()</strong>. Sometimes we had to change this value to +/- 1 to get reproducible fits.</li>
<li>Remove <code>lower</code> and <code>upper</code> arguments from the fitting process.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Daniel Padfield, Hannah O'Sullivan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
