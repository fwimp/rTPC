<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fitting multiple models to a TPC: model selection and model averaging • rTPC</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fitting multiple models to a TPC: model selection and model averaging">
<meta property="og:description" content="A brief example of how model selection or model averaging can be used when fitting multiple models to a single TPC using rTPC, nls.multstart, and the tidyverse. 
">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rTPC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro_to_rTPC.html">Modelling a thermal performance curve using rTPC</a>
    </li>
    <li>
      <a href="../articles/fitting_multiple_models_to_a_TPC.html">Fitting multiple models to a TPC using rTPC</a>
    </li>
    <li>
      <a href="../articles/model_averaging.html">Fitting multiple models to a TPC: model selection and model averaging</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/padpadpadpad/rTPC/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fitting multiple models to a TPC: model selection and model averaging</h1>
                        <h4 class="author">Daniel Padfield</h4>
            
            <h4 class="date">2020-06-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/padpadpadpad/rTPC/blob/mastervignettes/model_averaging.Rmd"><code>vignettes/model_averaging.Rmd</code></a></small>
      <div class="hidden name"><code>model_averaging.Rmd</code></div>

    </div>

    
    
<hr>
<div id="key-things-to-consider" class="section level3">
<h3 class="hasAnchor">
<a href="#key-things-to-consider" class="anchor"></a>Key things to consider</h3>
<hr>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co"># load packages</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">rTPC</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">nls.multstart</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">broom</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyverse</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggrepel</span>)</pre></body></html></div>
<p>The easiest pipeline demonstrates how models can be fitted, parameters extracted, and predictions plotted to single or multiple curves using functions in <strong>rTPC</strong>, <strong>nls_multstart()</strong>, and <strong>purrr</strong>.</p>
<p>Here, we demonstrate how this pipeline can easily be extended to do (1) model selection where the model that best supports the data is chosen or (2) model averaging where multiple models are used to make predictions or estimating extra parameters, weighted by how well they fit to the data. Instead of picking all 23 model formulations to demonstrate these approaches, we picked 5 models with different shaped curves (see <a href="fitting_multiple_models_to_a_TPC.html">this vignette</a>): <strong>boatman_2017()</strong>, <strong>gaussian_1987()</strong>, <strong>oneill_1972()</strong>, <strong>quadratic_2008()</strong>, <strong>rezende_2019()</strong>, and <strong>sharpeschoolhigh_1981()</strong></p>
<p>We can demonstrate the model averaging process for these model formulations by taking a single curve from the example dataset <strong>rTPC</strong> - a dataset of 60 TPCs of respiration and photosynthesis of the aquatic algae, <em>Chlorella vulgaris</em>. We can plot the data using <strong>ggplot2</strong>.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># load in data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"chlorella_tpc"</span>)

<span class="co"># keep just a single curve</span>
<span class="no">d</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">chlorella_tpc</span>, <span class="no">curve_id</span> <span class="kw">==</span> <span class="fl">1</span>)

<span class="co"># show the data</span>
<span class="fu">ggplot</span>(<span class="no">d</span>, <span class="fu">aes</span>(<span class="no">temp</span>, <span class="no">rate</span>)) +
  <span class="fu">geom_point</span>() +
  <span class="fu">theme_bw</span>(<span class="kw">base_size</span> <span class="kw">=</span> <span class="fl">12</span>) +
  <span class="fu">labs</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">'Temperature (ºC)'</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="st">'Metabolic rate'</span>,
       <span class="kw">title</span> <span class="kw">=</span> <span class="st">'Respiration across temperatures'</span>)</pre></body></html></div>
<p><img src="model_averaging_files/figure-html/first_plot-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The 5 models can then be fitted using the same approach as in the <a href="fitting_multiple_models_to_a_TPC.html">previous vignette</a>, using list columns <strong>purrr::map()</strong> to fit and store multiple models in a data frame.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># fit five chosen model formulation in rTPC</span>
<span class="no">d_fits</span> <span class="kw">&lt;-</span> <span class="fu">nest</span>(<span class="no">d</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">temp</span>, <span class="no">rate</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">boatman</span> <span class="kw">=</span> <span class="fu">map</span>(<span class="no">data</span>, ~<span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="no">rate</span>~<span class="fu"><a href="../reference/boatman_2017.html">boatman_2017</a></span>(<span class="kw">temp</span> <span class="kw">=</span> <span class="no">temp</span>, <span class="no">rmax</span>, <span class="no">tmin</span>, <span class="no">tmax</span>, <span class="no">a</span>,<span class="no">b</span>),
                        <span class="kw">data</span> <span class="kw">=</span> <span class="no">.x</span>,
                        <span class="kw">iter</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        <span class="kw">start_lower</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'boatman_2017'</span>) - <span class="fl">10</span>,
                        <span class="kw">start_upper</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'boatman_2017'</span>) + <span class="fl">10</span>,
                        <span class="kw">lower</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'boatman_2017'</span>),
                        <span class="kw">upper</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'boatman_2017'</span>),
                        <span class="kw">supp_errors</span> <span class="kw">=</span> <span class="st">'Y'</span>,
                        <span class="kw">convergence_count</span> <span class="kw">=</span> <span class="fl">FALSE</span>)),
         <span class="kw">gaussian</span> <span class="kw">=</span> <span class="fu">map</span>(<span class="no">data</span>, ~<span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="no">rate</span>~<span class="fu"><a href="../reference/gaussian_1987.html">gaussian_1987</a></span>(<span class="kw">temp</span> <span class="kw">=</span> <span class="no">temp</span>, <span class="no">rmax</span>, <span class="no">topt</span>, <span class="no">a</span>),
                        <span class="kw">data</span> <span class="kw">=</span> <span class="no">.x</span>,
                        <span class="kw">iter</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        <span class="kw">start_lower</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'gaussian_1987'</span>) - <span class="fl">10</span>,
                        <span class="kw">start_upper</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'gaussian_1987'</span>) + <span class="fl">10</span>,
                        <span class="kw">lower</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'gaussian_1987'</span>),
                        <span class="kw">upper</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'gaussian_1987'</span>),
                        <span class="kw">supp_errors</span> <span class="kw">=</span> <span class="st">'Y'</span>,
                        <span class="kw">convergence_count</span> <span class="kw">=</span> <span class="fl">FALSE</span>)),
         <span class="kw">oneill</span> <span class="kw">=</span> <span class="fu">map</span>(<span class="no">data</span>, ~<span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="no">rate</span>~<span class="fu"><a href="../reference/oneill_1972.html">oneill_1972</a></span>(<span class="kw">temp</span> <span class="kw">=</span> <span class="no">temp</span>, <span class="no">rmax</span>, <span class="no">ctmax</span>, <span class="no">topt</span>, <span class="no">q10</span>),
                        <span class="kw">data</span> <span class="kw">=</span> <span class="no">.x</span>,
                        <span class="kw">iter</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        <span class="kw">start_lower</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'oneill_1972'</span>) - <span class="fl">10</span>,
                        <span class="kw">start_upper</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'oneill_1972'</span>) + <span class="fl">10</span>,
                        <span class="kw">lower</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'oneill_1972'</span>),
                        <span class="kw">upper</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'oneill_1972'</span>),
                        <span class="kw">supp_errors</span> <span class="kw">=</span> <span class="st">'Y'</span>,
                        <span class="kw">convergence_count</span> <span class="kw">=</span> <span class="fl">FALSE</span>)),
         <span class="kw">quadratic</span> <span class="kw">=</span> <span class="fu">map</span>(<span class="no">data</span>, ~<span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="no">rate</span>~<span class="fu"><a href="../reference/quadratic_2008.html">quadratic_2008</a></span>(<span class="kw">temp</span> <span class="kw">=</span> <span class="no">temp</span>, <span class="no">a</span>, <span class="no">b</span>, <span class="no">c</span>),
                        <span class="kw">data</span> <span class="kw">=</span> <span class="no">.x</span>,
                        <span class="kw">iter</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        <span class="kw">start_lower</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'quadratic_2008'</span>) - <span class="fl">0.5</span>,
                        <span class="kw">start_upper</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'quadratic_2008'</span>) + <span class="fl">0.5</span>,
                        <span class="kw">lower</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'quadratic_2008'</span>),
                        <span class="kw">upper</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'quadratic_2008'</span>),
                        <span class="kw">supp_errors</span> <span class="kw">=</span> <span class="st">'Y'</span>,
                        <span class="kw">convergence_count</span> <span class="kw">=</span> <span class="fl">FALSE</span>)),
         <span class="kw">rezende</span> <span class="kw">=</span> <span class="fu">map</span>(<span class="no">data</span>, ~<span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="no">rate</span>~<span class="fu"><a href="../reference/rezende_2019.html">rezende_2019</a></span>(<span class="kw">temp</span> <span class="kw">=</span> <span class="no">temp</span>, <span class="no">q10</span>, <span class="no">a</span>,<span class="no">b</span>,<span class="no">c</span>),
                        <span class="kw">data</span> <span class="kw">=</span> <span class="no">.x</span>,
                        <span class="kw">iter</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        <span class="kw">start_lower</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'rezende_2019'</span>) - <span class="fl">10</span>,
                        <span class="kw">start_upper</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'rezende_2019'</span>) + <span class="fl">10</span>,
                        <span class="kw">lower</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'rezende_2019'</span>),
                        <span class="kw">upper</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'rezende_2019'</span>),
                        <span class="kw">supp_errors</span> <span class="kw">=</span> <span class="st">'Y'</span>,
                        <span class="kw">convergence_count</span> <span class="kw">=</span> <span class="fl">FALSE</span>)),
         <span class="kw">sharpeschoolhigh</span> <span class="kw">=</span> <span class="fu">map</span>(<span class="no">data</span>, ~<span class="fu"><a href="https://rdrr.io/pkg/nls.multstart/man/nls_multstart.html">nls_multstart</a></span>(<span class="no">rate</span>~<span class="fu"><a href="../reference/sharpeschoolhigh_1981.html">sharpeschoolhigh_1981</a></span>(<span class="kw">temp</span> <span class="kw">=</span> <span class="no">temp</span>, <span class="no">r_tref</span>,<span class="no">e</span>,<span class="no">eh</span>,<span class="no">th</span>, <span class="kw">tref</span> <span class="kw">=</span> <span class="fl">15</span>),
                        <span class="kw">data</span> <span class="kw">=</span> <span class="no">.x</span>,
                        <span class="kw">iter</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span>),
                        <span class="kw">start_lower</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'sharpeschoolhigh_1981'</span>) - <span class="fl">10</span>,
                        <span class="kw">start_upper</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_start_vals.html">get_start_vals</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'sharpeschoolhigh_1981'</span>) + <span class="fl">10</span>,
                        <span class="kw">lower</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_lower_lims.html">get_lower_lims</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'sharpeschoolhigh_1981'</span>),
                        <span class="kw">upper</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_upper_lims.html">get_upper_lims</a></span>(<span class="no">d</span>$<span class="no">temp</span>, <span class="no">d</span>$<span class="no">rate</span>, <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'sharpeschoolhigh_1981'</span>),
                        <span class="kw">supp_errors</span> <span class="kw">=</span> <span class="st">'Y'</span>,
                        <span class="kw">convergence_count</span> <span class="kw">=</span> <span class="fl">FALSE</span>)))</pre></body></html></div>
<p>The predictions of each model can be estimated using <strong>broom::augment()</strong>. This can be done on all models at once after the models are stacked into long format. To create a smooth curve fit, the predictions are done on a new temperature vector that has 100 points over the temperature range. The predictions for each model formulation are then visualised in <strong>ggplot2</strong>.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co"># stack models</span>
<span class="no">d_stack</span> <span class="kw">&lt;-</span> <span class="fu">select</span>(<span class="no">d_fits</span>, -<span class="no">data</span>) <span class="kw">%&gt;%</span>
  <span class="fu">pivot_longer</span>(<span class="no">.</span>, <span class="kw">names_to</span> <span class="kw">=</span> <span class="st">'model_name'</span>, <span class="kw">values_to</span> <span class="kw">=</span> <span class="st">'fit'</span>, <span class="no">boatman</span>:<span class="no">sharpeschoolhigh</span>)

<span class="co"># get predictions using augment</span>
<span class="no">newdata</span> <span class="kw">&lt;-</span> <span class="fu">tibble</span>(<span class="kw">temp</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">d</span>$<span class="no">temp</span>), <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">d</span>$<span class="no">temp</span>), <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">100</span>))
<span class="no">d_preds</span> <span class="kw">&lt;-</span> <span class="no">d_stack</span> <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="no">.</span>, <span class="kw">preds</span> <span class="kw">=</span> <span class="fu">map</span>(<span class="no">fit</span>, <span class="no">augment</span>, <span class="kw">newdata</span> <span class="kw">=</span> <span class="no">newdata</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(-<span class="no">fit</span>) <span class="kw">%&gt;%</span>
  <span class="fu">unnest</span>(<span class="no">preds</span>)

<span class="co"># take a random point from each model for labelling</span>
<span class="no">d_labs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">d_preds</span>, <span class="no">temp</span> <span class="kw">&lt;</span> <span class="fl">30</span>) <span class="kw">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="no">.</span>, <span class="no">model_name</span>) <span class="kw">%&gt;%</span>
  <span class="fu">sample_n</span>(<span class="no">.</span>, <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu">ungroup</span>()

<span class="co"># plot</span>
<span class="fu">ggplot</span>(<span class="no">d_preds</span>, <span class="fu">aes</span>(<span class="no">temp</span>, <span class="no">.fitted</span>)) +
  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="kw">col</span> <span class="kw">=</span> <span class="no">model_name</span>)) +
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_label_repel</a></span>(<span class="fu">aes</span>(<span class="no">temp</span>, <span class="no">.fitted</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="no">model_name</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="no">model_name</span>), <span class="kw">fill</span> <span class="kw">=</span> <span class="st">'white'</span>, <span class="kw">nudge_y</span> <span class="kw">=</span> <span class="fl">0.8</span>, <span class="kw">segment.size</span> <span class="kw">=</span> <span class="fl">0.2</span>, <span class="kw">segment.colour</span> <span class="kw">=</span> <span class="st">'grey50'</span>, <span class="no">d_labs</span>) +
  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="no">temp</span>, <span class="no">rate</span>), <span class="no">d</span>) +
  <span class="fu">theme_bw</span>(<span class="kw">base_size</span> <span class="kw">=</span> <span class="fl">12</span>) +
  <span class="fu">theme</span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">'none'</span>) +
  <span class="fu">labs</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">'Temperature (ºC)'</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="st">'Metabolic rate'</span>,
       <span class="kw">title</span> <span class="kw">=</span> <span class="st">'Respiration across temperatures'</span>) +
  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="kw">yintercept</span> <span class="kw">=</span> <span class="fl">0</span>), <span class="kw">linetype</span> <span class="kw">=</span> <span class="fl">2</span>) +
  <span class="fu">scale_color_brewer</span>(<span class="kw">type</span> <span class="kw">=</span> <span class="st">'qual'</span>, <span class="kw">palette</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="model_averaging_files/figure-html/preds_and_plot-1.png" width="576" style="display: block; margin: auto;"></p>
<p>As can be seen in the above plot, there is some variation in how the different model formulations fit to the data. We can use a information theoretic approach to compare between different models, using measures of relative model fit - such as AIC, BIC, and AICc (AICc correcting for small sample size). Which measure is most appropriate is going to be determined by the question being answered. AIC and BIC are both returned by <strong>broom::glance()</strong>, and AICc can be added using <strong>MuMIn::AICc()</strong></p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">d_ic</span> <span class="kw">&lt;-</span> <span class="no">d_stack</span> <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="no">.</span>, <span class="kw">info</span> <span class="kw">=</span> <span class="fu">map</span>(<span class="no">fit</span>, <span class="no">glance</span>),
         <span class="kw">AICc</span> <span class="kw">=</span>  <span class="fu">map_dbl</span>(<span class="no">fit</span>, <span class="kw pkg">MuMIn</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/MuMIn/man/AICc.html">AICc</a></span>)) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(-<span class="no">fit</span>) <span class="kw">%&gt;%</span>
  <span class="fu">unnest</span>(<span class="no">info</span>) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">model_name</span>, <span class="no">sigma</span>, <span class="no">AIC</span>, <span class="no">AICc</span>, <span class="no">BIC</span>, <span class="no">df.residual</span>)

<span class="no">d_ic</span>
<span class="co">#&gt; # A tibble: 6 x 6</span>
<span class="co">#&gt;   model_name       sigma    AIC  AICc   BIC df.residual</span>
<span class="co">#&gt;   &lt;chr&gt;            &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;int&gt;</span>
<span class="co">#&gt; 1 boatman          0.292 10.0    26.8 12.9            7</span>
<span class="co">#&gt; 2 gaussian         0.327 11.8    17.5 13.7            9</span>
<span class="co">#&gt; 3 oneill           0.266  7.38   17.4  9.81           8</span>
<span class="co">#&gt; 4 quadratic        0.408 17.1    22.8 19.0            9</span>
<span class="co">#&gt; 5 rezende          0.362 14.8    24.8 17.2            8</span>
<span class="co">#&gt; 6 sharpeschoolhigh 0.198  0.350  10.3  2.77           8</span></pre></body></html></div>
<p>In this instance, AICc score will be used to compare between models. For a model selection approach, the model with the lowest AICc score is chosen as the model that best supports the data. In this instance, it is the Sharpe-Schoolfield model.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co"># filter for best model</span>
<span class="no">best_model</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">d_ic</span>, <span class="no">AICc</span> <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">AICc</span>)) <span class="kw">%&gt;%</span> <span class="fu">pull</span>(<span class="no">model_name</span>)
<span class="no">best_model</span>
<span class="co">#&gt; [1] "sharpeschoolhigh"</span>

<span class="co"># get colour code</span>
<span class="no">col_best_mod</span> <span class="kw">=</span> <span class="kw pkg">RColorBrewer</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">6</span>, <span class="kw">name</span> <span class="kw">=</span> <span class="st">"Dark2"</span>)[<span class="fl">6</span>]

<span class="co"># plot</span>
<span class="fu">ggplot</span>(<span class="no">d_preds</span>, <span class="fu">aes</span>(<span class="no">temp</span>, <span class="no">.fitted</span>)) +
  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="kw">group</span> <span class="kw">=</span> <span class="no">model_name</span>), <span class="kw">col</span> <span class="kw">=</span> <span class="st">'grey50'</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.5</span>) +
  <span class="fu">geom_line</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">d_preds</span>, <span class="no">model_name</span> <span class="kw">==</span> <span class="no">best_model</span>), <span class="kw">col</span> <span class="kw">=</span> <span class="no">col_best_mod</span>) +
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_label_repel</a></span>(<span class="fu">aes</span>(<span class="no">temp</span>, <span class="no">.fitted</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="no">model_name</span>), <span class="kw">fill</span> <span class="kw">=</span> <span class="st">'white'</span>, <span class="kw">nudge_y</span> <span class="kw">=</span> <span class="fl">0.8</span>, <span class="kw">segment.size</span> <span class="kw">=</span> <span class="fl">0.2</span>, <span class="kw">segment.colour</span> <span class="kw">=</span> <span class="st">'grey50'</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">d_labs</span>, <span class="no">model_name</span> <span class="kw">==</span> <span class="no">best_model</span>), <span class="kw">col</span> <span class="kw">=</span> <span class="no">col_best_mod</span>) +
  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="no">temp</span>, <span class="no">rate</span>), <span class="no">d</span>) +
  <span class="fu">theme_bw</span>(<span class="kw">base_size</span> <span class="kw">=</span> <span class="fl">12</span>) +
  <span class="fu">theme</span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">'none'</span>) +
  <span class="fu">labs</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">'Temperature (ºC)'</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="st">'Metabolic rate'</span>,
       <span class="kw">title</span> <span class="kw">=</span> <span class="st">'Respiration across temperatures'</span>,
       <span class="kw">subtitle</span><span class="kw">=</span> <span class="st">'The Sharpe-Schoolfield model is the best model'</span>) +
  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="kw">yintercept</span> <span class="kw">=</span> <span class="fl">0</span>), <span class="kw">linetype</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="model_averaging_files/figure-html/model_selection-1.png" width="576" style="display: block; margin: auto;"></p>
<p>For a model averaging approach, predictions and parameters from the models are averaged. In ecology, this is usually done based on each model’s weighting. The best supported model’s predictions are taken into account more than the least supported. Often the number of models is reduced by setting a cut-off for the difference in whatever information criterion metric is being used. A common approach is to only keep models within <span class="math inline">\(\Delta 2 AIC\)</span> of the best model.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="co"># get model weights</span>
<span class="co"># filtering on AIC score is hashtagged out in this example</span>
<span class="no">d_ic</span> <span class="kw">&lt;-</span> <span class="no">d_ic</span> <span class="kw">%&gt;%</span>
  <span class="co"># filter(d_ic, aic - min(aic) &lt;= 2) %&gt;%</span>
  <span class="fu">mutate</span>(<span class="no">.</span>, <span class="kw">weight</span> <span class="kw">=</span> <span class="kw pkg">MuMIn</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/MuMIn/man/Weights.html">Weights</a></span>(<span class="no">AICc</span>))

<span class="fu">select</span>(<span class="no">d_ic</span>, <span class="no">model_name</span>, <span class="no">weight</span>) <span class="kw">%&gt;%</span>
  <span class="fu">arrange</span>(<span class="no">.</span>, <span class="fu">desc</span>(<span class="no">weight</span>))
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   model_name       weight      </span>
<span class="co">#&gt;   &lt;chr&gt;            &lt;mdl.wght&gt;  </span>
<span class="co">#&gt; 1 sharpeschoolhigh 0.9424218660</span>
<span class="co">#&gt; 2 oneill           0.0280227559</span>
<span class="co">#&gt; 3 gaussian         0.0267589370</span>
<span class="co">#&gt; 4 quadratic        0.0018576632</span>
<span class="co">#&gt; 5 rezende          0.0006905407</span>
<span class="co">#&gt; 6 boatman          0.0002482372</span>

<span class="co"># calculate average prediction</span>
<span class="no">ave_preds</span> <span class="kw">&lt;-</span> <span class="fu">left_join</span>(<span class="no">d_preds</span>, <span class="fu">select</span>(<span class="no">d_ic</span>, <span class="no">model_name</span>, <span class="no">weight</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="no">temp</span>) <span class="kw">%&gt;%</span>
  <span class="fu">summarise</span>(<span class="no">.</span>, <span class="kw">.fitted</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">.fitted</span>*<span class="no">weight</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">ungroup</span>() <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'model average'</span>)
<span class="co">#&gt; Joining, by = "model_name"</span>
<span class="co">#&gt; `summarise()` ungrouping output (override with `.groups` argument)</span>

<span class="co"># create label for averaged predictions</span>
<span class="no">d_labs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">ave_preds</span>, <span class="no">temp</span> <span class="kw">&lt;</span> <span class="fl">30</span>) <span class="kw">%&gt;%</span> <span class="fu">sample_n</span>(<span class="no">.</span>, <span class="fl">1</span>)

<span class="co"># plot these</span>
<span class="fu">ggplot</span>(<span class="no">d_preds</span>, <span class="fu">aes</span>(<span class="no">temp</span>, <span class="no">.fitted</span>)) +
  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="kw">col</span> <span class="kw">=</span> <span class="no">model_name</span>), <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.3</span>) +
  <span class="fu">geom_line</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">ave_preds</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">'blue'</span>) +
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_label_repel</a></span>(<span class="fu">aes</span>(<span class="kw">label</span> <span class="kw">=</span> <span class="no">model_name</span>), <span class="kw">fill</span> <span class="kw">=</span> <span class="st">'white'</span>, <span class="kw">nudge_y</span> <span class="kw">=</span> <span class="fl">0.8</span>, <span class="kw">segment.size</span> <span class="kw">=</span> <span class="fl">0.2</span>, <span class="kw">segment.colour</span> <span class="kw">=</span> <span class="st">'grey50'</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">d_labs</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">'blue'</span>) +
  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="no">temp</span>, <span class="no">rate</span>), <span class="no">d</span>) +
  <span class="fu">theme_bw</span>(<span class="kw">base_size</span> <span class="kw">=</span> <span class="fl">12</span>) +
  <span class="fu">theme</span>(<span class="kw">legend.position</span> <span class="kw">=</span> <span class="st">'none'</span>) +
  <span class="fu">labs</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">'Temperature (ºC)'</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="st">'Metabolic rate'</span>,
       <span class="kw">title</span> <span class="kw">=</span> <span class="st">'Respiration across temperatures'</span>,
       <span class="kw">subtitle</span><span class="kw">=</span> <span class="st">'Model averaged predictions'</span>) +
  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="kw">yintercept</span> <span class="kw">=</span> <span class="fl">0</span>), <span class="kw">linetype</span> <span class="kw">=</span> <span class="fl">2</span>) +
  <span class="fu">scale_color_brewer</span>(<span class="kw">type</span> <span class="kw">=</span> <span class="st">'qual'</span>, <span class="kw">palette</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="model_averaging_files/figure-html/model_weights-1.png" width="576" style="display: block; margin: auto;"></p>
<p>In this example, as is obvious from the model weights, the Sharpe-Schoolfield model is overwhelmingly the most supported. This plays out in the plot, with the predictions deviating very little from the predictions based on the Sharpe-Schoolfield model.</p>
<p>Model averaging can also be applied to estimated extra parameters, such as optimum temperature and maximum rate.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="co"># calculate estimated parameters</span>
<span class="no">params</span> <span class="kw">&lt;-</span> <span class="no">d_stack</span> <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="no">.</span>, <span class="kw">params</span> <span class="kw">=</span> <span class="fu">map</span>(<span class="no">fit</span>, <span class="no">est_params</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(-<span class="no">fit</span>) <span class="kw">%&gt;%</span>
  <span class="fu">unnest</span>(<span class="no">params</span>)

<span class="co"># get averaged parameters based on model weights</span>
<span class="no">ave_params</span> <span class="kw">&lt;-</span> <span class="fu">left_join</span>(<span class="no">params</span>, <span class="fu">select</span>(<span class="no">d_ic</span>, <span class="no">model_name</span>, <span class="no">weight</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">summarise</span>(<span class="no">.</span>, <span class="fu">across</span>(<span class="no">rmax</span>:<span class="no">skewness</span>, <span class="kw">function</span>(<span class="no">x</span>){<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">x</span>*<span class="no">.</span>$<span class="no">weight</span>)})) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">model_name</span> <span class="kw">=</span> <span class="st">'model average'</span>)
<span class="co">#&gt; Joining, by = "model_name"</span>

<span class="co"># show them</span>
<span class="fu">bind_rows</span>(<span class="fu">select</span>(<span class="no">params</span>, <span class="no">model_name</span>, <span class="no">rmax</span>:<span class="no">skewness</span>), <span class="no">ave_params</span>) <span class="kw">%&gt;%</span>
  <span class="fu">mutate_if</span>(<span class="no">is.numeric</span>, <span class="no">round</span>, <span class="fl">2</span>)
<span class="co">#&gt; # A tibble: 7 x 11</span>
<span class="co">#&gt;   model_name  rmax  topt ctmin ctmax     e    eh   q10 thermal_safety_…</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt; 1 boatman     1.56  38    0     48.1 0.72   1.74  2.48            10.1 </span>
<span class="co">#&gt; 2 gaussian    1.5   36.3 18.7   54.0 0.68   1.08  2.37            17.6 </span>
<span class="co">#&gt; 3 oneill      1.55  37.7 12.1   47.4 0.72   1.74  2.48             9.69</span>
<span class="co">#&gt; 4 quadratic   1.22  34.3 17.4   51.3 0.68   1.08  2.37            16.9 </span>
<span class="co">#&gt; 5 rezende     1.35  39.5 -3.41  48.7 0.72   1.74  2.48             9.14</span>
<span class="co">#&gt; 6 sharpesch…  1.81  41.6  2.54  45.6 0.580 11.5   2.06             3.91</span>
<span class="co">#&gt; 7 model ave…  1.8   41.4  3.26  45.8 0.59  10.9   2.08             4.47</span>
<span class="co">#&gt; # … with 2 more variables: tolerance_range &lt;dbl&gt;, skewness &lt;dbl&gt;</span></pre></body></html></div>
<hr>
</div>
<div id="further-reading" class="section level3">
<h3 class="hasAnchor">
<a href="#further-reading" class="anchor"></a>Further reading</h3>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Daniel Padfield, Hannah O'Sullivan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
